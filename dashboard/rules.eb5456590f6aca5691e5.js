(self.webpackChunkyacd=self.webpackChunkyacd||[]).push([[981],{66008:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return pe}});t(57327),t(82772);var n=t(85893),i=t(34699),s=t(96156),o=t(67294),a=t(86178),u=t(64478),c=t(88767),l=t(69834),f=t(2804),p=(t(41539),t(88674),t(87757)),d=t.n(p),v=(t(35666),t(92137)),h=t(97943);function y(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function g(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?y(Object(t),!0).forEach((function(r){(0,s.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function b(e){for(var r=e.providers,t=Object.keys(r),n={},i=0;i<t.length;i++){var s=t[i];n[s]=g(g({},r[s]),{},{idx:i})}return{byName:n,names:t}}function m(){return(m=(0,v.Z)(d().mark((function e(r,t){var n,i,s,o,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,h.g)(t),i=n.url,s=n.init,o={providers:{}},e.prev=2,e.next=5,fetch(i+r,s);case 5:if(!(a=e.sent).ok){e.next=10;break}return e.next=9,a.json();case 9:o=e.sent;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log("failed to GET /providers/rules",e.t0);case 15:return e.abrupt("return",b(o));case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function j(e){return O.apply(this,arguments)}function O(){return(O=(0,v.Z)(d().mark((function e(r){var t,n,i,s,o,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.name,n=r.apiConfig,i=(0,h.g)(n),s=i.url,o=i.init,e.prev=2,e.next=5,fetch(s+"/providers/rules/"+t,g({method:"PUT"},o));case 5:return a=e.sent,e.abrupt("return",a.ok);case 9:return e.prev=9,e.t0=e.catch(2),console.log("failed to PUT /providers/rules/:name",e.t0),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}t(21249);var x=t(41143),w=t.n(x);function P(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?P(Object(t),!0).forEach((function(r){(0,s.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function C(e){return w()(e.rules&&e.rules.length>=0,"there is no valid rules list in the rules API response"),e.rules.map((function(e,r){return k(k({},e),{},{id:r})}))}function Z(){return(Z=(0,v.Z)(d().mark((function e(r,t){var n,i,s,o,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={rules:[]},e.prev=1,i=(0,h.g)(t),s=i.url,o=i.init,e.next=5,fetch(s+r,o);case 5:if(!(a=e.sent).ok){e.next=10;break}return e.next=9,a.json();case 9:n=e.sent;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("failed to fetch rules",e.t0);case 15:return e.abrupt("return",C(n));case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}var E=t(86010),N=t(70296),_=t(25904),D=t(17132),S="_2F14Vs-eyF",L="x4HgsJSs_L",F="_1AQt0kcvQz",Q="_28wqsVo1h2",R="_1g-irMIYO_",T="_3HvVwQHShY",z="_3rwg4EbgB3";function A(e){var r=e.isRotating,t=(0,E.Z)(T,{[z]:r});return(0,n.jsx)("span",{className:t,children:(0,n.jsx)(a.Z,{width:16})})}function I(e){var r=e.idx,t=e.name,s=e.vehicleType,o=e.behavior,a=e.updatedAt,u=e.ruleCount,l=function(e,r){var t=(0,c.useQueryClient)(),n=(0,c.useMutation)(j,{onSuccess:function(){t.invalidateQueries("/providers/rules")}}),i=n.mutate;return[function(t){t.preventDefault(),i({name:e,apiConfig:r})},n.isLoading]}(t,e.apiConfig),f=(0,i.Z)(l,2),p=f[0],d=f[1],v=(0,N.Z)(new Date(a),new Date);return(0,n.jsxs)("div",{className:S,children:[(0,n.jsx)("span",{className:L,children:r}),(0,n.jsxs)("div",{className:F,children:[(0,n.jsx)(D.$,{name:t,type:`${s} / ${o}`}),(0,n.jsx)("div",{className:Q,children:u<2?u+" rule":u+" rules"}),(0,n.jsxs)("small",{className:Q,children:["Updated ",v," ago"]})]}),(0,n.jsx)("span",{className:R,children:(0,n.jsx)(_.Z,{onClick:p,disabled:d,children:(0,n.jsx)(A,{isRotating:d})})})]})}var V=t(44774),$=(0,f.cn)({key:"ruleFilterText",default:""}),M=t(57944);function W(){var e=(0,V.g)($),r=(0,i.Z)(e,2),t=r[0],s=r[1];return(0,n.jsx)("input",{className:M.Z.input,type:"text",value:s,onChange:t,placeholder:"Filter"})}var B=t(87462),Y=t(6055),q=t(82569),H="_2ZxnpAgEbI",K="_1Waxn5PO-y",U="_1YW1imuuRW",J="_3Anv9Ytzq4",X="_28txnmlSD3",G={_default:"#59caf9",DIRECT:"#f5bc41",REJECT:"#cb3166"};var ee=function(e){var r=e.type,t=e.payload,i=e.proxy,s=e.id,o=function(e){var r=e.proxy,t=G._default;return G[r]&&(t=G[r]),{color:t}}({proxy:i});return(0,n.jsxs)("div",{className:H,children:[(0,n.jsx)("div",{className:K,children:s}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:J,children:t}),(0,n.jsxs)("div",{className:U,children:[(0,n.jsx)("div",{className:X,children:r}),(0,n.jsx)("div",{style:o,children:i})]})]})]})},re="_3WrcX9K2WQ",te="_109LiAqCt-",ne=t(51525),ie=t(85295);function se(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function oe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?se(Object(t),!0).forEach((function(r){(0,s.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):se(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ae=o.memo,ue=o.useMemo,ce=o.useCallback;function le(e,r){var t=r.rules,n=r.provider,i=n.names.length;return e<i?n.names[e]:t[e-i].id}var fe=ae((function(e){var r=e.index,t=e.style,i=e.data,s=i.rules,o=i.provider,a=i.apiConfig,u=o.names.length;if(r<u){var c=o.names[r],l=o.byName[c];return(0,n.jsx)("div",{style:t,className:te,children:(0,n.jsx)(I,oe({apiConfig:a},l))})}var f=s[r-u];return(0,n.jsx)("div",{style:t,children:(0,n.jsx)(ee,oe({},f))})}),l.wy),pe=(0,ie.$j)((function(e){return{apiConfig:(0,Y.Y$)(e)}}))((function(e){var r=e.apiConfig,t=(0,B.Z)(),s=(0,i.Z)(t,2),o=s[0],p=s[1],d=ue((function(){return(0,n.jsx)(a.Z,{width:16})}),[]),v=function(e){var r=(0,c.useQuery)(["/rules",e],(function(){return function(e,r){return Z.apply(this,arguments)}("/rules",e)})),t=r.data,n=r.isFetching,s=(0,c.useQuery)(["/providers/rules",e],(function(){return function(e,r){return m.apply(this,arguments)}("/providers/rules",e)})).data,o=(0,f.FV)($),a=(0,i.Z)(o,1)[0];if(""===a)return{rules:t,provider:s,isFetching:n};var u=a.toLowerCase();return{rules:t.filter((function(e){return e.payload.toLowerCase().indexOf(u)>=0})),isFetching:n,provider:{byName:s.byName,names:s.names.filter((function(e){return e.toLowerCase().indexOf(u)>=0}))}}}(r),h=v.rules,y=v.provider,g=(O=(0,c.useQueryClient)(),ce((function(){O.invalidateQueries("/rules"),O.invalidateQueries("/providers/rules")}),[O])),b=function(e){var r=e.provider;return function(e){return e<r.names.length?90:80}}({rules:h,provider:y}),j=(0,u.$)().t;var O;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:re,children:[(0,n.jsx)(q.Z,{title:j("Rules")}),(0,n.jsx)(W,{})]}),(0,n.jsx)("div",{ref:o,style:{paddingBottom:30},children:(0,n.jsx)(l.S_,{height:p-30,width:"100%",itemCount:h.length+y.names.length,itemSize:b,itemData:{rules:h,provider:y,apiConfig:r},itemKey:le,children:fe})}),(0,n.jsx)(ne.Lg,{icon:d,text:"Refresh",style:ne.FK,onClick:g})]})}))},51525:function(e,r,t){"use strict";t.d(r,{aU:function(){return i.Action},Lg:function(){return i.Fab},$4:function(){return o},FK:function(){return a}});var n=t(85893),i=(t(67294),t(66018)),s="_3nmqcBZJL5";function o(e){var r=e.children;return(0,n.jsx)("span",{className:s,children:r})}var a={right:10,bottom:10}},87462:function(e,r,t){"use strict";t.d(r,{Z:function(){return c}});var n=t(34699),i=t(67294),s=i.useState,o=i.useRef,a=i.useCallback,u=i.useLayoutEffect;function c(){var e=o(null),r=s(200),t=(0,n.Z)(r,2),i=t[0],c=t[1],l=a((function(){var r=e.current.getBoundingClientRect().top;c(window.innerHeight-r)}),[]);return u((function(){return l(),window.addEventListener("resize",l),function(){window.removeEventListener("resize",l)}}),[l]),[e,i]}},44774:function(e,r,t){"use strict";t.d(r,{g:function(){return l}});var n=t(34699),i=t(80125),s=t(67294),o=t(2804),a=s.useCallback,u=s.useState,c=s.useMemo;function l(e){var r=(0,o.FV)(e),t=(0,n.Z)(r,2)[1],s=u(""),l=(0,n.Z)(s,2),f=l[0],p=l[1],d=c((function(){return(0,i.Z)(t,300)}),[t]);return[a((function(e){p(e.target.value),d(e.target.value)}),[d]),f]}},41143:function(e){"use strict";e.exports=function(e,r,t,n,i,s,o,a){if(!e){var u;if(void 0===r)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[t,n,i,s,o,a],l=0;(u=new Error(r.replace(/%s/g,(function(){return c[l++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}}},57944:function(e,r){"use strict";r.Z={input:"_1I0EXOg8Vu"}},86178:function(e,r,t){"use strict";var n=t(67294),i=t(45697),s=t.n(i);function o(){return(o=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function a(e,r){if(null==e)return{};var t,n,i=function(e,r){if(null==e)return{};var t,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(i[t]=e[t]);return i}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var u=(0,n.forwardRef)((function(e,r){var t=e.color,i=void 0===t?"currentColor":t,s=e.size,u=void 0===s?24:s,c=a(e,["color","size"]);return n.createElement("svg",o({ref:r,xmlns:"http://www.w3.org/2000/svg",width:u,height:u,viewBox:"0 0 24 24",fill:"none",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),n.createElement("polyline",{points:"23 4 23 10 17 10"}),n.createElement("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"}))}));u.propTypes={color:s().string,size:s().oneOfType([s().string,s().number])},u.displayName="RotateCw",r.Z=u}}]);
//# sourceMappingURL=rules.eb5456590f6aca5691e5.js.map